"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([["node_modules_pmcrypto-v6-canary_node_modules_openpgp_dist_lightweight_noble_curves_min_mjs"],{46504:(t,e,r)=>{r.d(e,{nobleCurves:()=>t1});var n=r(33558);/*! OpenPGP.js v6.0.0-beta.3.patch.1 - 2024-09-11 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class f extends n.H{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,n.h)(t);let r=(0,n.t)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let f=this.blockLen,i=new Uint8Array(f);i.set(r.length>f?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return(0,n.e)(this),this.iHash.update(t),this}digestInto(t){(0,n.e)(this),(0,n.b)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:n,destroyed:f,blockLen:i,outputLen:o}=this;return t.finished=n,t.destroyed=f,t.blockLen=i,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let i=(t,e,r)=>new f(t,e).update(r).digest();i.create=(t,e)=>new f(t,e)/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;let o=/* @__PURE__ */BigInt(0),a=/* @__PURE__ */BigInt(1),s=/* @__PURE__ */BigInt(2);function l(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function d(t){if(!l(t))throw Error("Uint8Array expected")}function c(t,e){if("boolean"!=typeof e)throw Error(`${t} must be valid boolean, got "${e}".`)}let h=/* @__PURE__ */Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function u(t){d(t);let e="";for(let r=0;r<t.length;r++)e+=h[t[r]];return e}function b(t){let e=t.toString(16);return 1&e.length?"0"+e:e}function g(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":"0x"+t)}let p={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function x(t){return t>=p._0&&t<=p._9?t-p._0:t>=p._A&&t<=p._F?t-(p._A-10):t>=p._a&&t<=p._f?t-(p._a-10):void 0}function y(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,f=0;e<r;e++,f+=2){let r=x(t.charCodeAt(f)),i=x(t.charCodeAt(f+1));if(void 0===r||void 0===i)throw Error('hex string expected, got non-hex character "'+(t[f]+t[f+1])+'" at index '+f);n[e]=16*r+i}return n}function w(t){return g(u(t))}function B(t){return d(t),g(u(Uint8Array.from(t).reverse()))}function m(t,e){return y(t.toString(16).padStart(2*e,"0"))}function E(t,e){return m(t,e).reverse()}function I(t,e,r){let n;if("string"==typeof e)try{n=y(e)}catch(r){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else{if(!l(e))throw Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}let f=n.length;if("number"==typeof r&&f!==r)throw Error(`${t} expected ${r} bytes, got ${f}`);return n}function v(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];d(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let f=t[e];r.set(f,n),n+=f.length}return r}let S=t=>"bigint"==typeof t&&o<=t;function A(t,e,r){return S(t)&&S(e)&&S(r)&&e<=t&&t<r}function L(t,e,r,n){if(!A(e,r,n))throw Error(`expected valid ${t}: ${r} <= n < ${n}, got ${typeof e} ${e}`)}function O(t){let e;for(e=0;t>o;t>>=a,e+=1);return e}let H=t=>(s<<BigInt(t-1))-a,R=t=>new Uint8Array(t),k=t=>Uint8Array.from(t);function F(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=R(t),f=R(t),i=0,o=()=>{n.fill(1),f.fill(0),i=0},a=(...t)=>r(f,n,...t),s=(t=R())=>{f=a(k([0]),t),n=a(),0!==t.length&&(f=a(k([1]),t),n=a())},l=()=>{if(i++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(n=a()).slice();r.push(e),t+=n.length}return v(...r)};return(t,e)=>{let r;for(o(),s(t);!(r=e(l()));)s();return o(),r}}let U={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||l(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function q(t,e,r={}){let n=(e,r,n)=>{let f=U[r];if("function"!=typeof f)throw Error(`Invalid validator "${r}", expected function`);let i=t[e];if(!(n&&void 0===i||f(i,t)))throw Error(`Invalid param ${e+""}=${i} (${typeof i}), expected ${r}`)};for(let[t,r]of Object.entries(e))n(t,r,!1);for(let[t,e]of Object.entries(r))n(t,e,!0);return t}function z(t){let e=new WeakMap;return(r,...n)=>{let f=e.get(r);if(void 0!==f)return f;let i=t(r,...n);return e.set(r,i),i}}var C=/*#__PURE__*/Object.freeze({__proto__:null,aInRange:L,abool:c,abytes:d,bitGet:function(t,e){return t>>BigInt(e)&a},bitLen:O,bitMask:H,bitSet:function(t,e,r){return t|(r?a:o)<<BigInt(e)},bytesToHex:u,bytesToNumberBE:w,bytesToNumberLE:B,concatBytes:v,createHmacDrbg:F,ensureBytes:I,equalBytes:function(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r},hexToBytes:y,hexToNumber:g,inRange:A,isBytes:l,memoized:z,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:m,numberToBytesLE:E,numberToHexUnpadded:b,numberToVarBytesBE:function(t){return y(b(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},validateObject:q});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let N=BigInt(0),_=BigInt(1),G=BigInt(2),P=BigInt(3),T=BigInt(4),$=BigInt(5),Z=BigInt(8);function j(t,e){let r=t%e;return r>=N?r:e+r}function D(t,e,r){if(r<=N||e<N)throw Error("Expected power/modulo > 0");if(r===_)return N;let n=_;for(;e>N;)e&_&&(n=n*t%r),t=t*t%r,e>>=_;return n}function V(t,e,r){let n=t;for(;e-- >N;)n*=n,n%=r;return n}function K(t,e){if(t===N||e<=N)throw Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=j(t,e),n=e,f=N,i=_;for(;r!==N;){let t=n%r,e=f-n/r*i;n=r,r=t,f=i,i=e}if(n!==_)throw Error("invert: does not exist");return j(f,e)}BigInt(9),BigInt(16);let M=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Y(t,e){let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function W(t,e,r=!1,n={}){if(t<=N)throw Error("Expected Field ORDER > 0, got "+t);let{nBitLength:f,nByteLength:i}=Y(t,e);if(i>2048)throw Error("Field lengths over 2048 bytes are not supported");let o=function(t){if(t%T===P){let e=(t+_)/T;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}if(t%Z===$){let e=(t-$)/Z;return function(t,r){let n=t.mul(r,G),f=t.pow(n,e),i=t.mul(r,f),o=t.mul(t.mul(i,G),f),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}}return function(t){let e,r,n;let f=(t-_)/G;for(e=t-_,r=0;e%G===N;e/=G,r++);for(n=G;n<t&&D(n,f,t)!==t-_;n++);if(1===r){let e=(t+_)/T;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}let i=(e+_)/G;return function(t,o){if(t.pow(o,f)===t.neg(t.ONE))throw Error("Cannot find square root");let a=r,s=t.pow(t.mul(t.ONE,n),e),l=t.pow(o,i),d=t.pow(o,e);for(;!t.eql(d,t.ONE);){if(t.eql(d,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(d);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(s,_<<BigInt(a-e-1));s=t.sqr(r),l=t.mul(l,r),d=t.mul(d,s),a=e}return l}}(t)}(t),a=Object.freeze({ORDER:t,BITS:f,BYTES:i,MASK:H(f),ZERO:N,ONE:_,create:e=>j(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("Invalid field element: expected bigint, got "+typeof e);return N<=e&&e<t},is0:t=>t===N,isOdd:t=>(t&_)===_,neg:e=>j(-e,t),eql:(t,e)=>t===e,sqr:e=>j(e*e,t),add:(e,r)=>j(e+r,t),sub:(e,r)=>j(e-r,t),mul:(e,r)=>j(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<N)throw Error("Expected power > 0");if(r===N)return t.ONE;if(r===_)return e;let n=t.ONE,f=e;for(;r>N;)r&_&&(n=t.mul(n,f)),f=t.sqr(f),r>>=_;return n})(a,t,e),div:(e,r)=>j(e*K(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>K(e,t),sqrt:n.sqrt||(t=>o(a,t)),invertBatch:t=>(function(t,e){let r=Array(e.length),n=e.reduce((e,n,f)=>t.is0(n)?e:(r[f]=e,t.mul(e,n)),t.ONE),f=t.inv(n);return e.reduceRight((e,n,f)=>t.is0(n)?e:(r[f]=t.mul(e,r[f]),t.mul(e,n)),f),r})(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?E(t,i):m(t,i),fromBytes:t=>{if(t.length!==i)throw Error(`Fp.fromBytes: expected ${i}, got ${t.length}`);return r?B(t):w(t)}});return Object.freeze(a)}function X(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function J(t){let e=X(t);return e+Math.ceil(e/2)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let Q=BigInt(0),tt=BigInt(1),te=new WeakMap,tr=new WeakMap;function tn(t,e){let r=(t,e)=>{let r=e.negate();return t?r:e},n=t=>{if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error(`Wrong window size=${t}, should be [1..${e}]`)},f=t=>(n(t),{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let n=t.ZERO,f=e;for(;r>Q;)r&tt&&(n=n.add(f)),f=f.double(),r>>=tt;return n},precomputeWindow(t,e){let{windows:r,windowSize:n}=f(e),i=[],o=t,a=o;for(let t=0;t<r;t++){a=o,i.push(a);for(let t=1;t<n;t++)a=a.add(o),i.push(a);o=a.double()}return i},wNAF(e,n,i){let{windows:o,windowSize:a}=f(e),s=t.ZERO,l=t.BASE,d=BigInt(2**e-1),c=2**e,h=BigInt(e);for(let t=0;t<o;t++){let e=t*a,f=Number(i&d);i>>=h,f>a&&(f-=c,i+=tt);let o=e+Math.abs(f)-1,u=t%2!=0,b=f<0;0===f?l=l.add(r(u,n[e])):s=s.add(r(b,n[o]))}return{p:s,f:l}},wNAFCached(t,e,r){let n=tr.get(t)||1,f=te.get(t);return f||(f=this.precomputeWindow(t,n),1!==n&&te.set(t,r(f))),this.wNAF(n,f,e)},setWindowSize(t,e){n(e),tr.set(t,e),te.delete(t)}}}function tf(t,e,r,n){if(!Array.isArray(r)||!Array.isArray(n)||n.length!==r.length)throw Error("arrays of points and scalars must have equal length");n.forEach((t,r)=>{if(!e.isValid(t))throw Error("wrong scalar at index "+r)}),r.forEach((e,r)=>{if(!(e instanceof t))throw Error("wrong point at index "+r)});let f=O(BigInt(r.length)),i=f>12?f-3:f>4?f-2:f?2:1,o=(1<<i)-1,a=Array(o+1).fill(t.ZERO),s=Math.floor((e.BITS-1)/i)*i,l=t.ZERO;for(let e=s;e>=0;e-=i){a.fill(t.ZERO);for(let t=0;t<n.length;t++){let f=Number(n[t]>>BigInt(e)&BigInt(o));a[f]=a[f].add(r[t])}let f=t.ZERO;for(let e=a.length-1,r=t.ZERO;e>0;e--)r=r.add(a[e]),f=f.add(r);if(l=l.add(f),0!==e)for(let t=0;t<i;t++)l=l.double()}return l}function ti(t){return q(t.Fp,M.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),q(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Y(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function to(t){void 0!==t.lowS&&c("lowS",t.lowS),void 0!==t.prehash&&c("prehash",t.prehash)}let{bytesToNumberBE:ta,hexToBytes:ts}=C,tl={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(t,e)=>{let{Err:r}=tl;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");let n=e.length/2,f=b(n);if(f.length/2&128)throw new r("tlv.encode: long form length too big");let i=n>127?b(f.length/2|128):"";return`${b(t)}${i}${f}${e}`},decode(t,e){let{Err:r}=tl,n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");let f=e[n++],i=0;if(128&f){let t=127&f;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");let o=e.subarray(n,n+t);if(o.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let t of o)i=i<<8|t;if(n+=t,i<128)throw new r("tlv.decode(long): not minimal encoding")}else i=f;let o=e.subarray(n,n+i);if(o.length!==i)throw new r("tlv.decode: wrong value length");return{v:o,l:e.subarray(n+i)}}},_int:{encode(t){let{Err:e}=tl;if(t<td)throw new e("integer: negative integers are not allowed");let r=b(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected assertion");return r},decode(t){let{Err:e}=tl;if(128&t[0])throw new e("Invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("Invalid signature integer: unnecessary leading zero");return ta(t)}},toSig(t){let{Err:e,_int:r,_tlv:n}=tl,f="string"==typeof t?ts(t):t;d(f);let{v:i,l:o}=n.decode(48,f);if(o.length)throw new e("Invalid signature: left bytes after parsing");let{v:a,l:s}=n.decode(2,i),{v:l,l:c}=n.decode(2,s);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){let{_tlv:e,_int:r}=tl,n=`${e.encode(2,r.encode(t.r))}${e.encode(2,r.encode(t.s))}`;return e.encode(48,n)}},td=BigInt(0),tc=BigInt(1);BigInt(2);let th=BigInt(3);function tu(t,e){let r=e=>(function(t){let e=function(t){let e=ti(t);return q(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n:n}=e,f=r.BYTES+1,i=2*r.BYTES+1;function o(t){return j(t,n)}let{ProjectivePoint:a,normPrivateKeyToScalar:s,weierstrassEquation:d,isWithinCurveOrder:h}=function(t){let e=function(t){let e=ti(t);q(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:f}=e;if(r){if(!n.eql(f,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=W(e.n,e.nBitLength),f=e.toBytes||((t,e,n)=>{let f=e.toAffine();return v(Uint8Array.from([4]),r.toBytes(f.x),r.toBytes(f.y))}),i=e.fromBytes||(t=>{let e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){let{a:n,b:f}=e,i=r.sqr(t),o=r.mul(i,t);return r.add(r.add(o,r.mul(t,n)),f)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw Error("bad generator point: equation left != right");function a(t){let r;let{allowedPrivateKeyLengths:n,nByteLength:f,wrapPrivateKey:i,n:o}=e;if(n&&"bigint"!=typeof t){if(l(t)&&(t=u(t)),"string"!=typeof t||!n.includes(t.length))throw Error("Invalid key");t=t.padStart(2*f,"0")}try{r="bigint"==typeof t?t:w(I("private key",t,f))}catch(e){throw Error(`private key must be ${f} bytes, hex or bigint, not ${typeof t}`)}return i&&(r=j(r,o)),L("private key",r,tc,o),r}function s(t){if(!(t instanceof b))throw Error("ProjectivePoint expected")}let d=z((t,e)=>{let{px:n,py:f,pz:i}=t;if(r.eql(i,r.ONE))return{x:n,y:f};let o=t.is0();null==e&&(e=o?r.ONE:r.inv(i));let a=r.mul(n,e),s=r.mul(f,e),l=r.mul(i,e);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw Error("invZ was invalid");return{x:a,y:s}}),h=z(t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw Error("bad point: ZERO")}let{x:n,y:f}=t.toAffine();if(!r.isValid(n)||!r.isValid(f))throw Error("bad point: x or y not FE");let i=r.sqr(f),a=o(n);if(!r.eql(i,a))throw Error("bad point: equation left != right");if(!t.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class b{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw Error("x required");if(null==e||!r.isValid(e))throw Error("y required");if(null==n||!r.isValid(n))throw Error("z required");Object.freeze(this)}static fromAffine(t){let{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw Error("invalid affine point");if(t instanceof b)throw Error("projective point not allowed");let f=t=>r.eql(t,r.ZERO);return f(e)&&f(n)?b.ZERO:new b(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(b.fromAffine)}static fromHex(t){let e=b.fromAffine(i(I("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return b.BASE.multiply(a(t))}static msm(t,e){return tf(b,n,t,e)}_setWindowSize(t){p.setWindowSize(this,t)}assertValidity(){h(this)}hasEvenY(){let{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){s(t);let{px:e,py:n,pz:f}=this,{px:i,py:o,pz:a}=t,l=r.eql(r.mul(e,a),r.mul(i,f)),d=r.eql(r.mul(n,a),r.mul(o,f));return l&&d}negate(){return new b(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:n}=e,f=r.mul(n,th),{px:i,py:o,pz:a}=this,s=r.ZERO,l=r.ZERO,d=r.ZERO,c=r.mul(i,i),h=r.mul(o,o),u=r.mul(a,a),g=r.mul(i,o);return g=r.add(g,g),d=r.mul(i,a),d=r.add(d,d),s=r.mul(t,d),l=r.mul(f,u),l=r.add(s,l),s=r.sub(h,l),l=r.add(h,l),l=r.mul(s,l),s=r.mul(g,s),d=r.mul(f,d),u=r.mul(t,u),g=r.sub(c,u),g=r.mul(t,g),g=r.add(g,d),d=r.add(c,c),c=r.add(d,c),c=r.add(c,u),c=r.mul(c,g),l=r.add(l,c),u=r.mul(o,a),u=r.add(u,u),c=r.mul(u,g),s=r.sub(s,c),d=r.mul(u,h),d=r.add(d,d),new b(s,l,d=r.add(d,d))}add(t){s(t);let{px:n,py:f,pz:i}=this,{px:o,py:a,pz:l}=t,d=r.ZERO,c=r.ZERO,h=r.ZERO,u=e.a,g=r.mul(e.b,th),p=r.mul(n,o),x=r.mul(f,a),y=r.mul(i,l),w=r.add(n,f),B=r.add(o,a);w=r.mul(w,B),B=r.add(p,x),w=r.sub(w,B),B=r.add(n,i);let m=r.add(o,l);return B=r.mul(B,m),m=r.add(p,y),B=r.sub(B,m),m=r.add(f,i),d=r.add(a,l),m=r.mul(m,d),d=r.add(x,y),m=r.sub(m,d),h=r.mul(u,B),d=r.mul(g,y),h=r.add(d,h),d=r.sub(x,h),h=r.add(x,h),c=r.mul(d,h),x=r.add(p,p),x=r.add(x,p),y=r.mul(u,y),B=r.mul(g,B),x=r.add(x,y),y=r.sub(p,y),y=r.mul(u,y),B=r.add(B,y),p=r.mul(x,B),c=r.add(c,p),p=r.mul(m,B),d=r.mul(w,d),d=r.sub(d,p),p=r.mul(w,x),h=r.mul(m,h),new b(d,c,h=r.add(h,p))}subtract(t){return this.add(t.negate())}is0(){return this.equals(b.ZERO)}wNAF(t){return p.wNAFCached(this,t,b.normalizeZ)}multiplyUnsafe(t){L("scalar",t,td,e.n);let n=b.ZERO;if(t===td)return n;if(t===tc)return this;let{endo:f}=e;if(!f)return p.unsafeLadder(this,t);let{k1neg:i,k1:o,k2neg:a,k2:s}=f.splitScalar(t),l=n,d=n,c=this;for(;o>td||s>td;)o&tc&&(l=l.add(c)),s&tc&&(d=d.add(c)),c=c.double(),o>>=tc,s>>=tc;return i&&(l=l.negate()),a&&(d=d.negate()),d=new b(r.mul(d.px,f.beta),d.py,d.pz),l.add(d)}multiply(t){let n,f;let{endo:i,n:o}=e;if(L("scalar",t,tc,o),i){let{k1neg:e,k1:o,k2neg:a,k2:s}=i.splitScalar(t),{p:l,f:d}=this.wNAF(o),{p:c,f:h}=this.wNAF(s);l=p.constTimeNegate(e,l),c=p.constTimeNegate(a,c),c=new b(r.mul(c.px,i.beta),c.py,c.pz),n=l.add(c),f=d.add(h)}else{let{p:e,f:r}=this.wNAF(t);n=e,f=r}return b.normalizeZ([n,f])[0]}multiplyAndAddUnsafe(t,e,r){let n=b.BASE,f=(t,e)=>e!==td&&e!==tc&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),i=f(this,e).add(f(t,r));return i.is0()?void 0:i}toAffine(t){return d(this,t)}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===tc)return!0;if(r)return r(b,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===tc?this:r?r(b,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return c("isCompressed",t),this.assertValidity(),f(b,this,t)}toHex(t=!0){return c("isCompressed",t),u(this.toRawBytes(t))}}b.BASE=new b(e.Gx,e.Gy,r.ONE),b.ZERO=new b(r.ZERO,r.ONE,r.ZERO);let g=e.nBitLength,p=tn(b,e.endo?Math.ceil(g/2):g);return{CURVE:e,ProjectivePoint:b,normPrivateKeyToScalar:a,weierstrassEquation:o,isWithinCurveOrder:function(t){return A(t,tc,e.n)}}}({...e,toBytes(t,e,n){let f=e.toAffine(),i=r.toBytes(f.x);return c("isCompressed",n),n?v(Uint8Array.from([e.hasEvenY()?2:3]),i):v(Uint8Array.from([4]),i,r.toBytes(f.y))},fromBytes(t){let e=t.length,n=t[0],o=t.subarray(1);if(e!==f||2!==n&&3!==n){if(e===i&&4===n)return{x:r.fromBytes(o.subarray(0,r.BYTES)),y:r.fromBytes(o.subarray(r.BYTES,2*r.BYTES))};throw Error(`Point of length ${e} was invalid. Expected ${f} compressed bytes or ${i} uncompressed bytes`)}{let t;let e=w(o);if(!A(e,tc,r.ORDER))throw Error("Point is not on curve");let f=d(e);try{t=r.sqrt(f)}catch(t){throw Error("Point is not on curve"+(t instanceof Error?": "+t.message:""))}return!(1&~n)!=((t&tc)===tc)&&(t=r.neg(t)),{x:e,y:t}}}}),b=t=>u(m(t,e.nByteLength)),g=(t,e,r)=>w(t.slice(e,r));class p{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let r=e.nByteLength;return new p(g(t=I("compactSignature",t,2*r),0,r),g(t,r,2*r))}static fromDER(t){let{r:e,s:r}=tl.toSig(I("DER",t));return new p(e,r)}assertValidity(){L("r",this.r,tc,n),L("s",this.s,tc,n)}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){let{r:f,s:i,recovery:s}=this,l=O(I("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let d=2===s||3===s?f+e.n:f;if(d>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let c=1&s?"03":"02",h=a.fromHex(c+b(d)),u=K(d,n),g=o(-l*u),p=o(i*u),x=a.BASE.multiplyAndAddUnsafe(h,g,p);if(!x)throw Error("point at infinify");return x.assertValidity(),x}hasHighS(){return this.s>n>>tc}normalizeS(){return this.hasHighS()?new p(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return y(this.toDERHex())}toDERHex(){return tl.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return y(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}function x(t){let e=l(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===f||n===i:r?n===2*f||n===2*i:t instanceof a}let S=e.bits2int||function(t){let r=w(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},O=e.bits2int_modN||function(t){return o(S(t))},R=H(e.nBitLength);function k(t){return L("num < 2^"+e.nBitLength,t,td,R),m(t,e.nByteLength)}let U={lowS:e.lowS,prehash:!1},C={lowS:e.lowS,prehash:!1};return a.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return a.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(x(t))throw Error("first arg must be private key");if(!x(e))throw Error("second arg must be public key");return a.fromHex(e).multiply(s(t)).toRawBytes(r)},sign:function(t,f,i=U){let{seed:l,k2sig:d}=function(t,f,i=U){if(["recovered","canonical"].some(t=>t in i))throw Error("sign() legacy options not supported");let{hash:l,randomBytes:d}=e,{lowS:c,prehash:u,extraEntropy:b}=i;null==c&&(c=!0),t=I("msgHash",t),to(i),u&&(t=I("prehashed msgHash",l(t)));let g=O(t),x=s(f),y=[k(x),k(g)];if(null!=b&&!1!==b){let t=!0===b?d(r.BYTES):b;y.push(I("extraEntropy",t))}return{seed:v(...y),k2sig:function(t){let e=S(t);if(!h(e))return;let r=K(e,n),f=a.BASE.multiply(e).toAffine(),i=o(f.x);if(i===td)return;let s=o(r*o(g+i*x));if(s===td)return;let l=(f.x===i?0:2)|Number(f.y&tc),d=s;return c&&s>n>>tc&&(d=s>n>>tc?o(-s):s,l^=1),new p(i,d,l)}}}(t,f,i);return F(e.hash.outputLen,e.nByteLength,e.hmac)(l,d)},verify:function(t,r,f,i=C){let s,d;if(r=I("msgHash",r),f=I("publicKey",f),"strict"in i)throw Error("options.strict was renamed to lowS");to(i);let{lowS:c,prehash:h}=i;try{if("string"==typeof t||l(t))try{s=p.fromDER(t)}catch(e){if(!(e instanceof tl.Err))throw e;s=p.fromCompact(t)}else{if("object"!=typeof t||"bigint"!=typeof t.r||"bigint"!=typeof t.s)throw Error("PARSE");{let{r:e,s:r}=t;s=new p(e,r)}}d=a.fromHex(f)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&s.hasHighS())return!1;h&&(r=e.hash(r));let{r:u,s:b}=s,g=O(r),x=K(b,n),y=o(g*x),w=o(u*x),B=a.BASE.multiplyAndAddUnsafe(d,y,w)?.toAffine();return!!B&&o(B.x)===u},ProjectivePoint:a,Signature:p,utils:{isValidPrivateKey(t){try{return s(t),!0}catch(t){return!1}},normPrivateKeyToScalar:s,randomPrivateKey:()=>{let t=J(e.n);return function(t,e,r=!1){let n=t.length,f=X(e),i=J(e);if(n<16||n<i||n>1024)throw Error(`expected ${i}-1024 bytes of input, got ${n}`);let o=j(r?w(t):B(t),e-_)+_;return r?E(o,f):m(o,f)}(e.randomBytes(t),e.n)},precompute:(t=8,e=a.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}})({...t,hash:e,hmac:(t,...r)=>i(e,t,(0,n.c)(...r)),randomBytes:n.r});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(4);let tb=W(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),tg=tu({a:tb.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:tb,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},n.s),tp=W(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),tx=tu({a:tp.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:tp,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},n.a),ty=W(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),tw={a:ty.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:ty,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},tB=tu({a:tw.a,b:tw.b,Fp:ty,n:tw.n,Gx:tw.Gx,Gy:tw.Gy,h:tw.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},n.d),tm=BigInt(0),tE=BigInt(1),tI=BigInt(2),tv=BigInt(8),tS={zip215:!0},tA=BigInt(0),tL=BigInt(1),tO=(0,n.w)(()=>n.f.create({dkLen:114})),tH=((0,n.w)(()=>n.f.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),tR=BigInt(1),tk=BigInt(2),tF=BigInt(3);BigInt(4);let tU=BigInt(11),tq=BigInt(22),tz=BigInt(44),tC=BigInt(88),tN=BigInt(223);function t_(t){let e=t*t*t%tH,r=e*e*t%tH,n=V(r,tF,tH)*r%tH,f=V(n,tF,tH)*r%tH,i=V(f,tk,tH)*e%tH,o=V(i,tU,tH)*i%tH,a=V(o,tq,tH)*o%tH,s=V(a,tz,tH)*a%tH,l=V(s,tC,tH)*s%tH,d=V(l,tz,tH)*a%tH,c=V(d,tk,tH)*e%tH,h=V(c,tR,tH)*t%tH;return V(h,tN,tH)*c%tH}function tG(t){return t[0]&=252,t[55]|=128,t[56]=0,t}let tP=W(tH,456,!0),tT=/* @__PURE__ */function(t){let e=function(t){let e=ti(t);return q(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n:n,prehash:f,hash:i,randomBytes:o,nByteLength:a,h:s}=e,l=tI<<BigInt(8*a)-tE,d=r.create,h=W(e.n,e.nBitLength),b=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:tm}}}),g=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,r)=>{if(c("phflag",r),e.length||r)throw Error("Contexts/pre-hash are not supported");return t});function x(t,e){L("coordinate "+t,e,tm,l)}function y(t){if(!(t instanceof S))throw Error("ExtendedPoint expected")}let w=z((t,e)=>{let{ex:n,ey:f,ez:i}=t,o=t.is0();null==e&&(e=o?tv:r.inv(i));let a=d(n*e),s=d(f*e),l=d(i*e);if(o)return{x:tm,y:tE};if(l!==tE)throw Error("invZ was invalid");return{x:a,y:s}}),m=z(t=>{let{a:r,d:n}=e;if(t.is0())throw Error("bad point: ZERO");let{ex:f,ey:i,ez:o,et:a}=t,s=d(f*f),l=d(i*i),c=d(o*o),h=d(c*c),u=d(s*r);if(d(c*d(u+l))!==d(h+d(n*d(s*l))))throw Error("bad point: equation left != right (1)");if(d(f*i)!==d(o*a))throw Error("bad point: equation left != right (2)");return!0});class S{constructor(t,e,r,n){this.ex=t,this.ey=e,this.ez=r,this.et=n,x("x",t),x("y",e),x("z",r),x("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof S)throw Error("extended point not allowed");let{x:e,y:r}=t||{};return x("x",e),x("y",r),new S(e,r,tE,d(e*r))}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.ez));return t.map((t,r)=>t.toAffine(e[r])).map(S.fromAffine)}static msm(t,e){return tf(S,h,t,e)}_setWindowSize(t){H.setWindowSize(this,t)}assertValidity(){m(this)}equals(t){y(t);let{ex:e,ey:r,ez:n}=this,{ex:f,ey:i,ez:o}=t,a=d(e*o),s=d(f*n),l=d(r*o),c=d(i*n);return a===s&&l===c}is0(){return this.equals(S.ZERO)}negate(){return new S(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:t}=e,{ex:r,ey:n,ez:f}=this,i=d(r*r),o=d(n*n),a=d(tI*d(f*f)),s=d(t*i),l=r+n,c=d(d(l*l)-i-o),h=s+o,u=h-a,b=s-o,g=d(c*u),p=d(h*b),x=d(c*b);return new S(g,p,d(u*h),x)}add(t){y(t);let{a:r,d:n}=e,{ex:f,ey:i,ez:o,et:a}=this,{ex:s,ey:l,ez:c,et:h}=t;if(r===BigInt(-1)){let t=d((i-f)*(l+s)),e=d((i+f)*(l-s)),r=d(e-t);if(r===tm)return this.double();let n=d(o*tI*h),u=d(a*tI*c),b=u+n,g=e+t,p=u-n,x=d(b*r),y=d(g*p),w=d(b*p);return new S(x,y,d(r*g),w)}let u=d(f*s),b=d(i*l),g=d(a*n*h),p=d(o*c),x=d((f+i)*(s+l)-u-b),w=p-g,B=p+g,m=d(b-r*u),E=d(x*w),I=d(B*m),v=d(x*m);return new S(E,I,d(w*B),v)}subtract(t){return this.add(t.negate())}wNAF(t){return H.wNAFCached(this,t,S.normalizeZ)}multiply(t){L("scalar",t,tE,n);let{p:e,f:r}=this.wNAF(t);return S.normalizeZ([e,r])[0]}multiplyUnsafe(t){return L("scalar",t,tm,n),t===tm?O:this.equals(O)||t===tE?this:this.equals(A)?this.wNAF(t).p:H.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(s).is0()}isTorsionFree(){return H.unsafeLadder(this,n).is0()}toAffine(t){return w(this,t)}clearCofactor(){let{h:t}=e;return t===tE?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){let{d:f,a:i}=e,o=r.BYTES;t=I("pointHex",t,o),c("zip215",n);let a=t.slice(),s=t[o-1];a[o-1]=-129&s;let h=B(a);L("pointHex.y",h,tm,n?l:r.ORDER);let u=d(h*h),{isValid:g,value:p}=b(d(u-tE),d(f*u-i));if(!g)throw Error("Point.fromHex: invalid y coordinate");let x=(p&tE)===tE,y=!!(128&s);if(!n&&p===tm&&y)throw Error("Point.fromHex: x=0 and x_0=1");return y!==x&&(p=d(-p)),S.fromAffine({x:p,y:h})}static fromPrivateKey(t){return R(t).point}toRawBytes(){let{x:t,y:e}=this.toAffine(),n=E(e,r.BYTES);return n[n.length-1]|=t&tE?128:0,n}toHex(){return u(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,tE,d(e.Gx*e.Gy)),S.ZERO=new S(tm,tE,tE,tm);let{BASE:A,ZERO:O}=S,H=tn(S,8*a);function R(t){t=I("private key",t,a);let e=I("hashed private key",i(t),2*a),r=g(e.slice(0,a)),f=e.slice(a,2*a),o=j(B(r),n),s=A.multiply(o),l=s.toRawBytes();return{head:r,prefix:f,scalar:o,point:s,pointBytes:l}}function k(t=new Uint8Array,...e){return j(B(i(p(v(...e),I("context",t),!!f))),n)}return A._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return R(t).pointBytes},sign:function(t,e,i={}){t=I("message",t),f&&(t=f(t));let{prefix:o,scalar:s,pointBytes:l}=R(e),d=k(i.context,o,t),c=A.multiply(d).toRawBytes(),h=j(d+k(i.context,c,l,t)*s,n);return L("signature.s",h,tm,n),I("result",v(c,E(h,r.BYTES)),2*a)},verify:function(t,e,n,i=tS){let o,a,s;let{context:l,zip215:d}=i,h=r.BYTES;t=I("signature",t,2*h),e=I("message",e),void 0!==d&&c("zip215",d),f&&(e=f(e));let u=B(t.slice(h,2*h));try{o=S.fromHex(n,d),a=S.fromHex(t.slice(0,h),d),s=A.multiplyUnsafe(u)}catch(t){return!1}if(!d&&o.isSmallOrder())return!1;let b=k(l,a.toRawBytes(),o.toRawBytes(),e);return a.add(o.multiplyUnsafe(b)).subtract(s).clearCofactor().equals(S.ZERO)},ExtendedPoint:S,utils:{getExtendedPublicKey:R,randomPrivateKey:()=>o(r.BYTES),precompute:(t=8,e=S.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}({a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:tP,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:tO,randomBytes:n.r,adjustScalarBytes:tG,domain:(t,e,r)=>{if(e.length>255)throw Error("Context is too big: "+e.length);return(0,n.c)((0,n.u)("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)},uvRatio:function(t,e){let r=j(t*t*e,tH),n=j(r*t,tH),f=j(n*r*e,tH),i=j(n*t_(f),tH),o=j(i*i,tH);return{isValid:j(o*e,tH)===t,value:i}}}),t$=function(t){let e=(q(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})),{P:r}=e,n=t=>j(t,r),f=e.montgomeryBits,i=Math.ceil(f/8),o=e.nByteLength,a=e.adjustScalarBytes||(t=>t),s=e.powPminus2||(t=>D(t,r-BigInt(2),r));function l(t,e,r){let f=n(t*(e-r));return[e=n(e-f),r=n(r+f)]}let d=(e.a-BigInt(2))/BigInt(4);function c(t,e){let c=function(t,e){L("u",t,tA,r),L("scalar",e,tA,r);let i,o=tL,a=tA,c=t,h=tL,u=tA;for(let r=BigInt(f-1);r>=tA;r--){let f=e>>r&tL;u^=f,o=(i=l(u,o,c))[0],c=i[1],a=(i=l(u,a,h))[0],h=i[1],u=f;let s=o+a,b=n(s*s),g=o-a,p=n(g*g),x=b-p,y=c+h,w=n((c-h)*s),B=n(y*g),m=w+B,E=w-B;c=n(m*m),h=n(t*n(E*E)),o=n(b*p),a=n(x*(b+n(d*x)))}return o=(i=l(u,o,c))[0],c=i[1],a=(i=l(u,a,h))[0],h=i[1],n(o*s(a))}(function(t){let e=I("u coordinate",t,i);return 32===o&&(e[31]&=127),B(e)}(e),function(t){let e=I("scalar",t),r=e.length;if(r!==i&&r!==o)throw Error(`Expected ${i} or ${o} bytes, got ${r}`);return B(a(e))}(t));if(c===tA)throw Error("Invalid private or public key received");return E(n(c),i)}let h=E(n(e.Gu),i);function u(t){return c(t,h)}return{scalarMult:c,scalarMultBase:u,getSharedSecret:(t,e)=>c(t,e),getPublicKey:t=>u(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:h}}({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:tH,Gu:BigInt(5),powPminus2:t=>j(V(t_(t),BigInt(2),tH)*t,tH),adjustScalarBytes:tG,randomBytes:n.r});tP.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let tZ=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),tj=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),tD=BigInt(1),tV=BigInt(2),tK=(t,e)=>(t+e/tV)/e,tM=W(tZ,void 0,void 0,{sqrt:function(t){let e=BigInt(3),r=BigInt(6),n=BigInt(11),f=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),s=t*t*t%tZ,l=s*s*t%tZ,d=V(l,e,tZ)*l%tZ,c=V(d,e,tZ)*l%tZ,h=V(c,tV,tZ)*s%tZ,u=V(h,n,tZ)*h%tZ,b=V(u,f,tZ)*u%tZ,g=V(b,o,tZ)*b%tZ,p=V(g,a,tZ)*g%tZ,x=V(p,o,tZ)*b%tZ,y=V(x,e,tZ)*l%tZ,w=V(y,i,tZ)*u%tZ,B=V(w,r,tZ)*s%tZ,m=V(B,tV,tZ);if(!tM.eql(tM.sqr(m),t))throw Error("Cannot find square root");return m}}),tY=tu({a:BigInt(0),b:BigInt(7),Fp:tM,n:tj,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-tD*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),f=BigInt("0x100000000000000000000000000000000"),i=tK(e*t,tj),o=tK(-r*t,tj),a=j(t-i*e-o*n,tj),s=j(-i*r-o*e,tj),l=a>f,d=s>f;if(l&&(a=tj-a),d&&(s=tj-s),a>f||s>f)throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:a,k2neg:d,k2:s}}}},n.s);BigInt(0),tY.ProjectivePoint;let tW=W(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),tX=tu({a:tW.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:tW,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},n.s),tJ=W(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),tQ=tu({a:tJ.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:tJ,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},n.a),t0=W(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),t1=new Map(Object.entries({nistP256:tg,nistP384:tx,nistP521:tB,brainpoolP256r1:tX,brainpoolP384r1:tQ,brainpoolP512r1:tu({a:t0.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:t0,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},n.d),secp256k1:tY,x448:t$,ed448:tT}))},33558:(t,e,r)=>{r.d(e,{C:()=>m,H:()=>y,M:()=>E,a:()=>V,b:()=>i,c:()=>x,d:()=>D,e:()=>a,f:()=>td,g:()=>I,h:()=>o,i:()=>h,j:()=>R,k:()=>ts,l:()=>tl,r:()=>B,s:()=>H,t:()=>p,u:()=>g,w:()=>w});/*! OpenPGP.js v6.0.0-beta.3.patch.1 - 2024-09-11 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */let n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function f(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, not "+t)}function i(t,...e){if(!(t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function o(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");f(t.outputLen),f(t.blockLen)}function a(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function s(t,e){i(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let l="object"==typeof n&&"crypto"in n?n.crypto:void 0,d=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),c=(t,e)=>t<<32-e|t>>>e,h=(t,e)=>t<<e|t>>>32-e>>>0,u=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function b(t){var e;for(let r=0;r<t.length;r++)t[r]=(e=t[r])<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}function g(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function p(t){return"string"==typeof t&&(t=g(t)),i(t),t}function x(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];i(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let f=t[e];r.set(f,n),n+=f.length}return r}class y{clone(){return this._cloneInto()}}function w(t){let e=e=>t().update(p(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function B(t=32){if(l&&"function"==typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(t));if(l&&"function"==typeof l.randomBytes)return l.randomBytes(t);throw Error("crypto.getRandomValues must be defined")}let m=(t,e,r)=>t&e^~t&r,E=(t,e,r)=>t&e^t&r^e&r;class I extends y{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=d(this.buffer)}update(t){a(this);let{view:e,buffer:r,blockLen:n}=this,f=(t=p(t)).length;for(let i=0;i<f;){let o=Math.min(n-this.pos,f-i);if(o!==n)r.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(e,0),this.pos=0);else{let e=d(t);for(;n<=f-i;i+=n)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){a(this),s(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:n,isLE:f}=this,{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>n-i&&(this.process(r,0),i=0);for(let t=i;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let f=BigInt(32),i=BigInt(0xffffffff),o=Number(r>>f&i),a=Number(r&i),s=n?4:0,l=n?0:4;t.setUint32(e+s,o,n),t.setUint32(e+l,a,n)}(r,n-8,BigInt(8*this.length),f),this.process(r,0);let o=d(t),l=this.outputLen;if(l%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=l/4,h=this.get();if(c>h.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)o.setUint32(4*t,h[t],f)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:f,destroyed:i,pos:o}=this;return t.length=n,t.pos=o,t.finished=f,t.destroyed=i,n%e&&t.buffer.set(r),t}}let v=/* @__PURE__ */new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),S=/* @__PURE__ */new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),A=/* @__PURE__ */new Uint32Array(64);class L extends I{constructor(){super(64,32,8,!1),this.A=0|S[0],this.B=0|S[1],this.C=0|S[2],this.D=0|S[3],this.E=0|S[4],this.F=0|S[5],this.G=0|S[6],this.H=0|S[7]}get(){let{A:t,B:e,C:r,D:n,E:f,F:i,G:o,H:a}=this;return[t,e,r,n,f,i,o,a]}set(t,e,r,n,f,i,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|f,this.F=0|i,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)A[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=A[t-15],r=A[t-2],n=c(e,7)^c(e,18)^e>>>3,f=c(r,17)^c(r,19)^r>>>10;A[t]=f+A[t-7]+n+A[t-16]|0}let{A:r,B:n,C:f,D:i,E:o,F:a,G:s,H:l}=this;for(let t=0;t<64;t++){let e=l+(c(o,6)^c(o,11)^c(o,25))+m(o,a,s)+v[t]+A[t]|0,d=(c(r,2)^c(r,13)^c(r,22))+E(r,n,f)|0;l=s,s=a,a=o,o=i+e|0,i=f,f=n,n=r,r=e+d|0}r=r+this.A|0,n=n+this.B|0,f=f+this.C|0,i=i+this.D|0,o=o+this.E|0,a=a+this.F|0,s=s+this.G|0,l=l+this.H|0,this.set(r,n,f,i,o,a,s,l)}roundClean(){A.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class O extends L{constructor(){super(),this.A=-0x3efa6128,this.B=0x367cd507,this.C=0x3070dd17,this.D=-0x8f1a6c7,this.E=-4191439,this.F=0x68581511,this.G=0x64f98fa7,this.H=-0x4105b05c,this.outputLen=28}}let H=/* @__PURE__ */w(()=>new L),R=/* @__PURE__ */w(()=>new O),k=/* @__PURE__ */BigInt(0x100000000-1),F=/* @__PURE__ */BigInt(32);function U(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let f=0;f<t.length;f++){let{h:i,l:o}=function(t,e=!1){return e?{h:Number(t&k),l:Number(t>>F&k)}:{h:0|Number(t>>F&k),l:0|Number(t&k)}}(t[f],e);[r[f],n[f]]=[i,o]}return[r,n]}let q=(t,e,r)=>t<<r|e>>>32-r,z=(t,e,r)=>e<<r|t>>>32-r,C=(t,e,r)=>e<<r-32|t>>>64-r,N=(t,e,r)=>t<<r-32|e>>>64-r,_={split:U,shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,add:function(t,e,r,n){let f=(e>>>0)+(n>>>0);return{h:t+r+(f/0x100000000|0)|0,l:0|f}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,n)=>e+r+n+(t/0x100000000|0)|0,add4L:(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),add4H:(t,e,r,n,f)=>e+r+n+f+(t/0x100000000|0)|0,add5H:(t,e,r,n,f,i)=>e+r+n+f+i+(t/0x100000000|0)|0,add5L:(t,e,r,n,f)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(f>>>0)},[G,P]=_.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),T=/* @__PURE__ */new Uint32Array(80),$=/* @__PURE__ */new Uint32Array(80);class Z extends I{constructor(){super(128,64,16,!1),this.Ah=0x6a09e667,this.Al=-0xc4336f8,this.Bh=-0x4498517b,this.Bl=-0x7b3558c5,this.Ch=0x3c6ef372,this.Cl=-0x16b07d5,this.Dh=-0x5ab00ac6,this.Dl=0x5f1d36f1,this.Eh=0x510e527f,this.El=-0x52197d2f,this.Fh=-0x64fa9774,this.Fl=0x2b3e6c1f,this.Gh=0x1f83d9ab,this.Gl=-0x4be4295,this.Hh=0x5be0cd19,this.Hl=0x137e2179}get(){let{Ah:t,Al:e,Bh:r,Bl:n,Ch:f,Cl:i,Dh:o,Dl:a,Eh:s,El:l,Fh:d,Fl:c,Gh:h,Gl:u,Hh:b,Hl:g}=this;return[t,e,r,n,f,i,o,a,s,l,d,c,h,u,b,g]}set(t,e,r,n,f,i,o,a,s,l,d,c,h,u,b,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|f,this.Cl=0|i,this.Dh=0|o,this.Dl=0|a,this.Eh=0|s,this.El=0|l,this.Fh=0|d,this.Fl=0|c,this.Gh=0|h,this.Gl=0|u,this.Hh=0|b,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)T[r]=t.getUint32(e),$[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|T[t-15],r=0|$[t-15],n=_.rotrSH(e,r,1)^_.rotrSH(e,r,8)^_.shrSH(e,r,7),f=_.rotrSL(e,r,1)^_.rotrSL(e,r,8)^_.shrSL(e,r,7),i=0|T[t-2],o=0|$[t-2],a=_.rotrSH(i,o,19)^_.rotrBH(i,o,61)^_.shrSH(i,o,6),s=_.rotrSL(i,o,19)^_.rotrBL(i,o,61)^_.shrSL(i,o,6),l=_.add4L(f,s,$[t-7],$[t-16]),d=_.add4H(l,n,a,T[t-7],T[t-16]);T[t]=0|d,$[t]=0|l}let{Ah:r,Al:n,Bh:f,Bl:i,Ch:o,Cl:a,Dh:s,Dl:l,Eh:d,El:c,Fh:h,Fl:u,Gh:b,Gl:g,Hh:p,Hl:x}=this;for(let t=0;t<80;t++){let e=_.rotrSH(d,c,14)^_.rotrSH(d,c,18)^_.rotrBH(d,c,41),y=_.rotrSL(d,c,14)^_.rotrSL(d,c,18)^_.rotrBL(d,c,41),w=d&h^~d&b,B=c&u^~c&g,m=_.add5L(x,y,B,P[t],$[t]),E=_.add5H(m,p,e,w,G[t],T[t]),I=0|m,v=_.rotrSH(r,n,28)^_.rotrBH(r,n,34)^_.rotrBH(r,n,39),S=_.rotrSL(r,n,28)^_.rotrBL(r,n,34)^_.rotrBL(r,n,39),A=r&f^r&o^f&o,L=n&i^n&a^i&a;p=0|b,x=0|g,b=0|h,g=0|u,h=0|d,u=0|c,({h:d,l:c}=_.add(0|s,0|l,0|E,0|I)),s=0|o,l=0|a,o=0|f,a=0|i,f=0|r,i=0|n;let O=_.add3L(I,S,L);r=_.add3H(O,E,v,A),n=0|O}({h:r,l:n}=_.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:f,l:i}=_.add(0|this.Bh,0|this.Bl,0|f,0|i)),({h:o,l:a}=_.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:s,l:l}=_.add(0|this.Dh,0|this.Dl,0|s,0|l)),({h:d,l:c}=_.add(0|this.Eh,0|this.El,0|d,0|c)),({h:h,l:u}=_.add(0|this.Fh,0|this.Fl,0|h,0|u)),({h:b,l:g}=_.add(0|this.Gh,0|this.Gl,0|b,0|g)),({h:p,l:x}=_.add(0|this.Hh,0|this.Hl,0|p,0|x)),this.set(r,n,f,i,o,a,s,l,d,c,h,u,b,g,p,x)}roundClean(){T.fill(0),$.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class j extends Z{constructor(){super(),this.Ah=-0x344462a3,this.Al=-0x3efa6128,this.Bh=0x629a292a,this.Bl=0x367cd507,this.Ch=-0x6ea6fea6,this.Cl=0x3070dd17,this.Dh=0x152fecd8,this.Dl=-0x8f1a6c7,this.Eh=0x67332667,this.El=-4191439,this.Fh=-0x714bb579,this.Fl=0x68581511,this.Gh=-0x24f3d1f3,this.Gl=0x64f98fa7,this.Hh=0x47b5481d,this.Hl=-0x4105b05c,this.outputLen=48}}let D=/* @__PURE__ */w(()=>new Z),V=/* @__PURE__ */w(()=>new j),K=[],M=[],Y=[],W=/* @__PURE__ */BigInt(0),X=/* @__PURE__ */BigInt(1),J=/* @__PURE__ */BigInt(2),Q=/* @__PURE__ */BigInt(7),tt=/* @__PURE__ */BigInt(256),te=/* @__PURE__ */BigInt(113);for(let t=0,e=X,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],K.push(2*(5*n+r)),M.push((t+1)*(t+2)/2%64);let f=W;for(let t=0;t<7;t++)(e=(e<<X^(e>>Q)*te)%tt)&J&&(f^=X<<(X<</* @__PURE__ */BigInt(t))-X);Y.push(f)}let[tr,tn]=/* @__PURE__ */U(Y,!0),tf=(t,e,r)=>r>32?C(t,e,r):q(t,e,r),ti=(t,e,r)=>r>32?N(t,e,r):z(t,e,r);class to extends y{constructor(t,e,r,n=!1,i=24){var o;if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,f(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=new Uint32Array((o=this.state).buffer,o.byteOffset,Math.floor(o.byteLength/4))}keccak(){u||b(this.state32),function(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let n=(e+8)%10,f=(e+2)%10,i=r[f],o=r[f+1],a=tf(i,o,1)^r[n],s=ti(i,o,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=s}let e=t[2],f=t[3];for(let r=0;r<24;r++){let n=M[r],i=tf(e,f,n),o=ti(e,f,n),a=K[r];e=t[a],f=t[a+1],t[a]=i,t[a+1]=o}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=tr[n],t[1]^=tn[n]}r.fill(0)}(this.state32,this.rounds),u||b(this.state32),this.posOut=0,this.pos=0}update(t){a(this);let{blockLen:e,state:r}=this,n=(t=p(t)).length;for(let f=0;f<n;){let i=Math.min(e-this.pos,n-f);for(let e=0;e<i;e++)r[this.pos++]^=t[f++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,128&e&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){a(this,!1),i(t),this.finish();let e=this.state,{blockLen:r}=this;for(let n=0,f=t.length;n<f;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,f-n);t.set(e.subarray(this.posOut,this.posOut+i),n),this.posOut+=i,n+=i}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return f(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(s(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:n,rounds:f,enableXOF:i}=this;return t||(t=new to(e,r,n,i,f)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=f,t.suffix=r,t.outputLen=n,t.enableXOF=i,t.destroyed=this.destroyed,t}}let ta=(t,e,r)=>w(()=>new to(e,t,r)),ts=/* @__PURE__ */ta(6,136,32),tl=/* @__PURE__ */ta(6,72,64),td=function(t){let e=(e,r)=>t(r).update(p(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}((t={})=>new to(136,31,void 0===t.dkLen?32:t.dkLen,!0))}}]);
